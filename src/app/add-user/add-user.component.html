<div class="container mt-5">
  <div class="row mb-3">
    <div class="col-sm-12">
      <h2>Add New User</h2>
    </div>
  </div>
  
  <div class="row mb-3">
    <div class="col-sm-12">
      <form [formGroup]="userForm">
        <div class="row mb-3">
          <div class="col-sm-12">
            <div class="form-group">
              <label>Name: <span class="text-danger">*</span> </label>
              <input
                type="text"
                placeholder="Full Name"
                formControlName="name"
                class="form-control"
              />
              <span
                *ngIf="
                  submitted ||
                  forms['name'].dirty ||
                  (forms['name'].touched && forms['name'].invalid)
                "
                class="info-msg text-danger"
              >
                <small
                  *ngIf="forms['name'].errors && 
                        forms['name'].errors?.['required']"
                >
                  Full Name is required !
                </small>
              </span>
            </div>
          </div>
        </div>
      
        <div class="row mb-3">
          <div class="col-sm-12">
            <div class="form-group">
              <label>Email: <span class="text-danger">*</span> </label>
              <input
                type="email"
                placeholder="Email"
                formControlName="email"
                class="form-control"
              />
              <span
                *ngIf="
                  submitted ||
                  forms['email'].dirty ||
                  (forms['email'].touched && forms['email'].invalid)
                "
                class="info-msg text-danger"
              >
                <small
                  *ngIf="forms['email'].errors && 
                        forms['email'].errors?.['required']"
                >
                  Email is required !
                </small>
              </span>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-sm-12">
            <div class="form-group">
              <label>Password: <span class="text-danger">*</span> </label>
              <input
                type="password"
                placeholder="Password"
                formControlName="password"
                class="form-control"
              />
              <span
                *ngIf="
                  submitted ||
                  forms['password'].dirty ||
                  (forms['password'].touched && forms['password'].invalid)
                "
                class="info-msg text-danger"
              >
                <small
                  *ngIf="forms['password'].errors && 
                        forms['password'].errors?.['required']"
                >
                  Password is required !
                </small>
              </span>
            </div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-sm-12">
            <div class="form-group">
              <label>Mobile Number: <span class="text-danger">*</span> </label>
              <input
                type="text"
                formControlName="mobileNumber"
                placeholder="Mobile Number"
                class="form-control"
              />
              <span
                *ngIf="
                  submitted ||
                  forms['mobileNumber'].dirty ||
                  (forms['mobileNumber'].touched &&
                    forms['mobileNumber'].invalid)
                "
                class="info-msg text-danger"
              >
                <small
                  *ngIf="forms['mobileNumber'].errors && 
                        forms['mobileNumber'].errors?.['required']"
                >
                  Mobile Number is required !
                </small>
                <small
                  *ngIf="forms['mobileNumber'].errors && forms['mobileNumber'].errors?.['minlength']"
                  >Mobile Number must be at least 10 characters long !</small
                >
              </span>
            </div>
          </div>
        </div>

        <ng-container
          formArrayName="contacts"
          *ngFor="let data of getContactForm?.controls; let i = index"
        >
          <div class="row mb-3" [formGroupName]="i">
            <div class="col-sm-6">
              <div class="form-group">
                <label
                  >Contact Number: <span class="text-danger">*</span>
                </label>
                <input
                  type="text"
                  name="mobileNumber"
                  id="mobileNumber"
                  formControlName="mobileNumber"
                  placeholder=" Contact Mobile Number"
                  class="form-control"
                />
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label
                  >Contact Email: <span class="text-danger">*</span>
                </label>
                <input
                  type="text"
                  name="email"
                  id="email"
                  formControlName="email"
                  placeholder="Contact Email"
                  class="form-control"
                />
                <span
                  *ngIf="
                    submitted ||
                    forms['email'].dirty ||
                    (forms['email'].touched && forms['email'].invalid)
                  "
                  class="info-msg text-danger"
                >
                  <small
                    *ngIf="forms['email'].errors && 
                        forms['email'].errors?.['required']"
                  >
                    Contact Email is required !
                  </small>
                </span>
              </div>
            </div >
            <div class="col-sm-6 mt-2">
              <button class="btn btn-success"  *ngIf="getContactForm.length > 1"  (click)="removeContacts(i)" >
                Remove
              </button>
            </div>

            
          </div>
        </ng-container>
        <div class="row mb-3">
          <div class="col-sm-6">
            <button class="btn btn-success" (click)="initContacts()">
              Add More
            </button>
          </div>
          

          <div class="row mb-3">
            <div class="col-sm-6">
              <div class="form-group">
                <label>DOB: <span class="text-danger">*</span> </label>
                <input
                  type="date"
                  formControlName="dob"
                  placeholder="big-endian (YYYY/MM/DD)"
                  class="form-control"
                  required
                  (change)="convertDateToAge()"
                />
                <span
                  *ngIf="
                    submitted ||
                    forms['dob'].dirty ||
                    (forms['dob'].touched && forms['dob'].invalid)
                  "
                  class="info-msg text-danger"
                >
                  <small
                    *ngIf="forms['dob'].errors && 
                        forms['dob'].errors?.['required']"
                  >
                    DOB is required !
                  </small>
                </span>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="form-group">
                <label>Age: <span class="text-danger">*</span> </label>
                <input
                  type="number"
                  formControlName="age"
                  placeholder="Age"
                  class="form-control"
                  readonly
                />
              </div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-sm-6">
              <button
                (click)="onAddUser(userForm.value)"
                class="btn btn-success"
              >
                Add User
              </button>
            </div>
          </div>
        </div>
      
      </form>
    </div>
  </div>
</div>
